<HTML><HEAD>
<TITLE>Функция ungetc</TITLE>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=Windows-1251"> 
<LINK REL=STYLESHEET TYPE="text/css" HREF="../work/css.css">
</HEAD><BODY>
<A href="../main.htm#13">Содержание</A> | <A href="13.htm#00">Глава 13</A><HR>
<H1>Функция ungetc</H1>
<PRE>
#include &lt;stdio.h&gt;
int ungetc(int <I>ch</I>, FILE *<I>stream</I>);
</PRE>
<P class="tj">Функция <KBD>ungetc()</KBD> возвращает в поток ввода <I>stream</I> символ, заданный младшим байтом параметра <I>ch</I>. Затем этот символ будет получен при последующей операции чтения потока <I>stream</I>. Обращение к таким функциям, как <KBD>fflush()</KBD>, <KBD>fseek()</KBD> и <KBD>rewind()</KBD>, аннулирует действие <KBD>ungetc()</KBD> и сбрасывает этот символ.
<P class="tj">Гарантируется, что в поток можно возвратить один символ, однако некоторые реализации допускают возврат большего числа символов.
<P class="tj">Попытка вернуть в поток ввода значение <KBD>EOF</KBD> игнорируется.
<P class="tj">Обращение к функции <KBD>ungetc()</KBD> очищает признак конца файла, связанный с заданным потоком. Значение указателя текущей позиции файла для текстового потока не определено до тех пор, пока не будут прочитаны все возвращенные обратно в поток символы, в этом случае оно остается таким же, каким было до первого вызова функции <KBD>ungetc()</KBD>. При работе с потоками в двоичном режиме каждый вызов функции <KBD>ungetc()</KBD> уменьшает указатель текущей позиции файла.
<P class="tj">При успешном завершении функция возвращает значение <I>ch</I>, в противном случае — значение <KBD>EOF</KBD>.
<H2>Пример</H2>
<P class="tj">Данная функция читает слова из входного потока, адресуемого указателем <KBD>fp</KBD>. Разделитель возвращается в поток для последующего использования. Например, если входные данные имеют вид count/10, то при первом обращении к функции read_word() она возвратит count, a символ "/" направит обратно во входной поток.
<PRE>
void read_word(FILE *fp, char *token)
{
  while(isalpha(*token=getc(fp))) token++;
  ungetc(*token, fp);
}
</PRE>
<H2>Зависимые функции</H2>
<A href="getc.htm">getc()</A>
<HR><A href="../main.htm#13">Содержание</A> | <A href="13.htm#00">Глава 13</A>
</BODY></HTML>