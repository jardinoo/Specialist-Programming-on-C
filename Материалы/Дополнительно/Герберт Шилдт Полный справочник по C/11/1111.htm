<HTML><HEAD>
<TITLE>Массивы с переменными границами в качестве членов структур</TITLE>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=Windows-1251"> 
<LINK REL=STYLESHEET TYPE="text/css" HREF="../work/css.css">
</HEAD><BODY>
<A href="../main.htm#11">Содержание</A> | <A href="1110.htm">&lt;&lt;&lt;</A> | <A href="1112.htm">&gt;&gt;&gt;</A><HR>
<H1>Массивы с переменными границами в качестве членов структур</H1>
<P class='tj'>С99 дает возможность в качестве последнего члена структуры указывать массив без размера. (В структуре перед гибким массивом-членом должен стоять как минимум еше один член.) Он называется <I>членом-массивом с переменными границами</I>. Таким образом, структура может иметь в качестве члена массив переменного размера. В размере такой структуры, возвращаемом <KBD>sizeof</KBD>, память для гибкого массива не учитывается.
<P class='tj'>Обычно память для структуры с членом-массивом с переменными границами распределяется автоматически, с помощью <KBD>malloc()</KBD>. Кроме размера структуры, необходимо еше выделить дополнительную память, чтобы разместить член-массив с переменными границами нужного размера. Например, если имеется следующее определение структуры
<PRE>
sturct mystruct {
  int a;
  int b;
  float fa[]; //массив с переменными границами
};
</PRE>
<P class='t'>то при выполнении следующего кода будет выделяться место для массива из 10 элементов:
<PRE>
struct mystruct *p;
p = (struct mystruct *) malloc(sizof(struct mystuct) + 10 *
sizof(float);)
</PRE>
<P class='tj'>Так как <KBD>sizeof (struct mystruct)</KBD> дает значение, в котором не учтен размер памяти для <KBD>fa</KBD>, то при вызове <KBD>malloc()</KBD> с помощью выражения
<PRE>10 *sizof(float)</PRE>
<P class='t'>дополнительно выделяется место для размещения массива из 10 элементов типа <KBD>float</KBD>.
<HR><A href="../main.htm#11">Содержание</A> | <A href="1110.htm">&lt;&lt;&lt;</A> | <A href="1112.htm">&gt;&gt;&gt;</A>
</BODY></HTML>