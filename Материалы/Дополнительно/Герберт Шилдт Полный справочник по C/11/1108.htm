<HTML><HEAD>
<TITLE>Изменения препроцессора</TITLE>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=Windows-1251"> 
<LINK REL=STYLESHEET TYPE="text/css" HREF="../work/css.css">
</HEAD><BODY>
<A href="../main.htm#11">Содержание</A> | <A href="1107.htm">&lt;&lt;&lt;</A> | <A href="1109.htm">&gt;&gt;&gt;</A><HR>
<H1>Изменения препроцессора</H1>
<P class="tj">Стандарт С99 внес небольшие изменения и в препроцессор.
<H2>Переменные списки аргументов</H2>
<P class="tj">Возможно, самым важным изменением препроцессора является возможность обрабатывать макросы с переменным количеством аргументов. На переменное количество аргументов указывает многоточие (...),  находящееся  в определении макроса. Встроенный препроцессорный идентификатор <KBD>__VA_ARGS__</KBD> 	определяет, куда будут подставляться аргументы. Например, после включения в программу определения
<PRE>#define MyMax(...) max(__VA_ARGS__)</PRE>
<P>выражение
<PRE>MyMax(a, b);</PRE>
<P>преобразуется в
<PRE>max(a, b);</PRE>
<P class="tj">До обозначения переменного количества аргументов (...) макрос может иметь другие аргументы. Например, после определения
<PRE>#define compare(compfunc, ...) compfunc(__VA_ARGS__)</PRE>
<P>оператор
<PRE>compare(strcmp, "один", "два");</PRE>
<P>преобразуется в оператор
<PRE>strcmp("один", "два");</PRE>
<P class="tj">Как видно из примера, встроенный идентификатор <KBD>__VA_ARGS__</KBD> заменяется всеми остальными аргументами.
<H2>Оператор _Pragma</H2>
<P class="tj">С выходом С99 в языке С появился еще один способ определять прагму в программе: оператор <KBD>_Pragma</KBD>. В общем виде этот оператор выглядит таким образом:
<PRE>_Pragma(<I>"директива"</I>)</PRE>
<P class="tj">Здесь <I>директива</I> — это вызываемая <I>прагма</I><SUP><A href="#11" name="1">[1]</A></SUP>. Появление оператора <KBD>_Pragma</KBD> дает прагмам возможность участвовать в макрозамене.
<H2>Встроенные прагмы</H2>
<P class="tj">
<TABLE align=center border=1 width=100%>
<TR><TH>Прагма<TH>Что означает
<TR><TD>STDC&nbsp;FP_CONTRACT&nbsp;ON/OFF/DEFAULT<TD class="t">Во включенном состоянии (ON) выражения с плавающей точкой считаются неделимыми структурами, которые обрабатываются с помощью аппаратуры. Состояние по умолчанию (DEFAULT) определяется реализацией.
<TR><TD>STDC&nbsp;FENV_ACCESS&nbsp;ON/OFF/DEFAULT<TD class="t">Сообщает компилятору, что доступна аппаратура для выполнения операций с плавающей точкой. Состояние по умолчанию определяется реализацией.
<TR><TD>STDC&nbsp;CX_LIMITED_RANGE&nbsp;ON/OFF/DEFAULT<TD class="t">Во включенном состоянии (ON)сообщает компилятору, что некоторые формулы с составными значениями являются безопасными. Отключенное состояние (OFF) задается по умолчанию.
</TABLE>
<P class="tj">Подробные сведения об этих прагмах должны быть приведены в документации по компилятору.
<H2>Новые встроенные макросы</H2>
<P class="tj">К макросам, поддерживаемым С89, в С99 добавлены следующие:</P>
<TABLE align=center border=1 width=100%>
<TR><TD>__STDC_HOSTED__<TD class="t">1, если имеется операционная система
<TR><TD>__STDC_VERSION__<TD class="t">не меньше, чем 199901L; представляет версию языка С
<TR><TD>__STDC_IЕС_559__<TD class="t">1, если поддерживаются арифметические операции с плавающей запятой IEC 60559
<TR><TD>__STDC_IEC_559_COMPLEX__<TD class="t">1, если поддерживаются арифметические операции с комплексными числами IEC 60559
<TR><TD>__STDC_ISO_10646__<TD class="t">Значение в виде гггглшЬ, которое указывает год и месяц выхода спецификации ISO/IEC 10646, поддерживаемой компилятором
</TABLE>
<P><IMG src="../work/sup.bmp" alt="----------">
<BLOCKQUOTE>
<P class="tj"><SUP><A href="#1" name="11">[1]</A></SUP><I>Прагма</I> называется также <I>указанием транслятору, псевдокомментарием, директивой транслятора, указанием компилятору, директивой компилятора</I>.
</BLOCKQUOTE>
<HR><A href="../main.htm#11">Содержание</A> | <A href="1107.htm">&lt;&lt;&lt;</A> | <A href="1109.htm">&gt;&gt;&gt;</A>
</BODY></HTML>